<!DOCTYPE html>
<html>
  <head>
    <title>Albums</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <style>
   @font-face {
    font-family: jukeboxfont;
    src: url("/fonts/KeeponTruckin.ttf");
    }

     @font-face {
    font-family: typewriter;
    src: url("/fonts/atwriter.ttf");
    }
    </style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

<script>
    function play_sound_queue() {
      
      var myaudio = document.getElementById("audioplayer")
      document.getElementById("audioplayer").src = songs[0];
      document.getElementById("trackname").innerHTML = songnames[0];
      if(songs.length>0){
          myaudio.addEventListener('ended', nextrack);
          function nextrack(){
            myaudio.removeEventListener('ended', nextrack)
            console.log("hit");
            songs.shift(); 
            songnames.shift();
            play_sound_queue();
          }
      }
      if(songnames.length == 0){
        document.getElementById("trackname").innerHTML = "";
      }
    }

    function togglePlay() {
      return myAudio.paused ? myAudio.play() : myAudio.pause();
    };
    
    var songs = [];
    var songnames = [];
   
  
    function play_all() {
      
      if(songs.length ==1){
      play_sound_queue();
      }
    }
    
  </script>


  </head>

  <body>
    <audio  id="audioplayer" onplay = "checkplay()" onpause = "checkpause()" autoplay class = "playbutton"  src = ""  > </audio> 
    <a href="javascript:;" onclick="play_all();">PLAY THIS!</a>
    <a href="javascript:;" onclick="togglePlay();">Pause!</a>

    <%= yield %>
  </body>
</html>
